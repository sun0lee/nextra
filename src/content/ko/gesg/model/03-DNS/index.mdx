---
title: "DNS 모델"
---
# DNS 모형 (Dynamic Nelson Siegel Moddel)

## Nelson-Siegel Model 
NS모형은 금융시장에서 금리기간구조(다양한 만기별 채권 수익률)를 하나의 모형으로 설명하려는 시도에서 시작되었다. 특정 시점의 금리 기간구조를 예측하기 위해 Level, Slope, Curvature 세 가지 특성으로 구분하여 설명한다. 

||factor|설명|의미|
|:--:|:--:|--|--|
|$\beta_0$| **Level** | 전체 수익률 곡선의 높이 | 모든 만기의 금리가 함께 오르거나 내리는 정도. 장기인플레이션 기대, 경제성장 전망 등.|
|$\beta_1$| **Slope** | 단기 금리와 장기 금리 간의 차이 (장-단기 스프레드)| 경기순환에 따라 수익률 곡선이 우상향하거나 플랫하거나, 역전되는 경우가 있는데 기울기가 이러한 팩터 변화를 설명함. |
|$\beta_2$| **Curvature** | 중간만기 (5~7년) 금리가 단기 및 장기 금리에 비해 상대적으로 얼마나 높거나 낮은지를 결정하는 형태.| 위로 볼록하거나 아래로 오목한 형태로 나타남. 중기적인 경기 전망에 대한 불확실성이나 유동성 프리미엄 등이 관련 있음. |

<GMath title ="[참고] Nelson-Siegel 모형">
$$
r(\tau) = \beta_0 + \beta_1(\frac{1-e^{-\lambda \tau}}{\lambda \tau}) + \beta_2 (\frac{1-e^{-\lambda \tau}}{\lambda \tau}- e^{-\lambda \tau})
$$
</GMath>
<GCmt>
- • $r(\tau)$ : 만기가 $\tau$인 채권의 수익률 (금리)
- • $\beta_0$ : Level Factor : $\tau$ 만기가 무한대로 갈수록 $e^{-\lambda \tau}$항이 0에 수렴하므로 $r(\tau)$는 $\beta_0$에 가까워짐. 
- • $\beta_1$ : Slope Factor
- • $\beta_2$ : Curvature Factor
- • $\lambda$ : Decay Factor 각 팩터가 금리커브의 각 만기에 얼마나 빠르게 영향을 미치는지 조절하는 모수. 즉, 이 값이 작을수록 팩터의 영향이 천천히 미치고, 클수록 단기에 빠르게 그 효과가 반영됨.
</GCmt>


## Dynamic Nelson Siegel Moddel 
시간에 따라 변화하는 금리의 복잡한 움직임을 예측하기 위해, DNS 모형은 NS모형을 동적으로 확장한 케이스이다. 즉, 금리 기간구조(수익률 곡선)를 구성하는 세 가지 요소를 상수가 아니라 **시간에 따라 변하는** 상태변수로 설명하는 모형이다. Dynamic-NS 모형은 Nelson-Siegel모형에서 $\beta_0$, $\beta_1$, $\beta_2$ 와 같은 팩터들이 상수가 아니라 시간에 따라 동적(Dynamic)으로 바뀌는 요소 ($L_t, S_t, C_t$)로 가정하고 이러한 상태변수의 움직임을 통계적으로 추정한다. 즉 평가시점에 따라 (어제, 내일, 1달후) 금리의 레벨, 기울기, 곡률이 다른 것을 상태변수로 반영하는 것이다.

<GMath title ="Dynamic Nelson-Siegel 모형">
$$
r(\tau) = L_t + S_t(\frac{1-e^{-\lambda \tau}}{\lambda \tau}) + C_t (\frac{1-e^{-\lambda \tau}}{\lambda \tau}- e^{-\lambda \tau})
$$
</GMath>


#### 상태공간모형 
    상태공간모형(State Space Model)은 관측할 수 없는 상태변수의 움직임을 관측할 수 있는 데이터를 통해 추정하고 예측하는 통계모형

    |상태변수 | 관측가능 데이터 |
    |--|--|
    |State variable|observation|
    |level, slope, curvature| 금리데이터 $R(\tau)$|
    |상태방정식<br/>$$\beta_t = C + \Phi \beta_{t-1} + \eta_t$$|측정방정식<br/>$$r(\tau) = \beta_0 + \beta_1(\frac{1-e^{-\lambda \tau}}{\lambda \tau})$$ <br/>$$+ \beta_2 (\frac{1-e^{-\lambda \tau}}{\lambda \tau}- e^{-\lambda \tau}) + \epsilon_t $$ |
    |$\eta_t  \sim \mathcal{N}(0,Q)$ <br/>상태방정식 오차 공분산행렬 $Q$|$\epsilon_t \sim \mathcal{N}(0, R)$ <br/>측정방정식 오차 공분산행렬 $R$|
    

    - • $Q$ 행렬은 레벨, 기울기, 곡률 팩터들이 시간이 지남에 따라 어떻게 함께 변하는지를 나타냄
    - • $Q$ 행렬은 미래 팩터 값들을 예측하고, 예측의 불확실성을 계산하는 데 사용된다. 특히 스트레스 시나리오를 생성할 때 팩터들이 실제 시장에서 발생 가능한 방식으로 함께 움직이도록 하는 데 결정적인 역할을 한다.
    
    - • $R$ 행렬은 관측되는 금리데이터가 얼마나 정확한지, 각 만기별 금리 측정치들간에 어떤 측정 오차 상관관계가 있는지 나타냄
    - • $R$은 칼만 필터의 갱신 단계에서 현재 측정값(금리 데이터)의 신뢰도를 결정하는 데 사용된다. 
      - – 만약 R이 작다면 (측정 오차가 작다는 의미), 칼만 필터는 새로운 측정값을 더 신뢰하여 상태 변수 추정치를 강하게 업데이트
      - – 만약 R이 크다면 (측정 오차가 크다는 의미), 칼만 필터는 새로운 측정값에 덜 의존하고, 예측된 상태 변수 값을 더 신뢰함

    팩터들은 동적으로 움직이는 확률변수들로 정의한다. 팩터들의 움직임을 상태공간모형으로 설명한다.
    횡단면적 추정으로 매일의 팩터값을 얻고, 이 값들의 시계열을 통해 팩터의 움직임을 추정한다. 


<GCallout severity="success" title ="Kalman Filter">
칼만필터는 noise가 있는 측정값을 사용하여 시스템의 관측할 수 없는 상태(state)를 추정하는 최적의 재귀적 알고리즘을 의미함. 
새로운 측정값이 들어올 때마다 과거의 모든 데이터를 다시 처리할 필요없이, 바로 이전 시점의 추정치와 현재의 새로운 측정값으로 현재시점의 추정치를 업데이트하는 방식으로 작동함. 

1. 예측 
    - • 미래상태 예측 : 이전시점에 추정된 상태변수를 기반으로 상태방정식을 사용하여 현재시점의 상태변수가 어떻게 될 것인지 예측
    - • 예측 불확실성 계싼 : 시스템 오차로 인한 불확실성이 포함됨. 

2. 갱신
    - • 새로운 측정값 확보 : 현재시점의 실제 관측데이터 
    - • 측정 오차 고려
    - • 예측과 측정값 결합 : 예측단계에서 얻은 예측치와 새로운 측정값을 결합하여 현재시점의 최적의 상태 추정치를 계산함. 측정값의 신뢰도, 예측값의 신뢰도를 활용. (Kalman gain : 측정값을 얼마나 신뢰하고 현재 추정치를 업데이트 할것인가? 가중치 )
    - • 불확실성(오차 공분산) 갱신 

</GCallout>


#### 벡터자기회귀모형 
  <GMath title ="(Vector AutoRegressive, VAR)">
        $$
        \beta_t = C + \Phi \beta_{t-1} + \epsilon_t
        $$
  </GMath>
      - $\beta_t = [\beta_{0,t}, \beta_{1,t} ,\beta_{2,t} ]^T$ $t$시점에서의 레벨, 기울기, 곡률팩터 벡터 
      - $C$ : 상수벡터 (평균회귀 경향 )
      - $\Phi$ : 팩터간 자기상관관계 및 교차상관관계 행렬 (현재시점의 팩터 값이 이전 팩터 값에 어떻게 영향을 받는지)
      - $\epsilon_t$ : 오차항, 평균이 0이고 공분산행렬이 $\Sigma$ 인 정규분포를 따름.

    팩터들이 과거 값에 의존하며 움직이며, 오차항이 더해져 동적으로 변하는 것을 나타냄.


## DNS 모형을 이용한 금리 충격시나리오 산출과정
<Steps>
### 과거 데이터 분석 및 모형 추정
- 장기간 과거 금리 데이터 수집
- 수집한 데이터를 이용하여 DNS모형의 팩터와 $\lambda$를 추정함. 팩터의 시간에 따른 변화(시계열 특성) 분석

### 팩터의 변동성 및 상관관계 분석
- 추정한 팩터가 과거에 얼마나 변동했는지(표준편차) 및 팩터들간의 상관관계 분석

### Calibration 
    1. 초기 $\lambda$ 설정 
    2. 팩터 추정
        - • 횡단면적 추정 : 매일 매일의 수익률곡선 데이터를 가지고 각 날짜의 $\beta_{0,t}$, $\beta_{1,t}$ ,$\beta_{2,t}$를 추정함. 주어진 $\lambda$와 $R(\tau)$를 이용하여 모형오차를 최소화 하는 $\beta$를 추정함.
        - • 시계열적 추정 : 벡터자기회귀모형이나, 상태공간모형을 이용하여, 추정된 $\beta_{0,t}$, $\beta_{1,t}$ ,$\beta_{2,t}$ 가 시간에 따라 어떻게 움직이는지 분석함 (팩터 간 표준편차 및 팩터 간 상관관계 산출)



### 충격시나리오 생성
- – 99.5% 충격시나리오 (과거의 팩터 변동 기준으로 worst 99.5% 수준의 극단적 팩터 변화) 
- – 산출된 각 팩터의 공분산행렬을 이용하여 팩터간의 상관관계를 반영한 충격벡터를 생성함.

팩터들의 변동성과 상관관계를 활용하여 과거이 발생했을법한 극단적인 팩터의 움직임을 가정하여 99.5% 충격 시나리오를 산출한다.

<Accordion activeIndex={[0]}>
<AccordionTab header="팩터 변동성의 통계적 특성 파악 Q  ">
    - – $Q$ 대각선 요소 : $Var(\eta_i)$는 각 팩터의 변동성을 의미함 
    - – $Q$ 비대각 요소 : $Cov(\eta_i , eta_j)$는 팩터간 상관관계를 의미함
            
</AccordionTab>
<AccordionTab header="충격강도 : 99.5% VaR ">
    - – 2.58 표준편차에 해당하는 값. 각 팩터가 평소 움직이는 폭의 2.58배의 극단적인 움직임.
            
</AccordionTab>
<AccordionTab header="다변량 충격벡터 생성  ">
    - – 팩터들이 독립적으로 움직이지 않고 서로 상관관계를 갖으므로 단순히 팩터에 2.58 상수배로 충격량을 산출할 수 없음. 
    - – 상관관계가 있는 변수들을 통계적으로 다루기 쉽고 독립적인 변수들의 선형결합으로 재구성함. 
            
    <GCallout severity="success" title ="Cholesky Decomposition">
    1. $Q$행렬을 $L\cdot L^T$로 분해한다. $L$은 하삼각행렬로 공분산행렬의 제곱근 
    2. 각 팩터에 대한 독립적인 표준정규확률변수들 ($z_0,z_1,z_2$)를 생성한다.
    3. $z = [z_0,z_1,z_2]^T$ 에 $L$을 곱하여 상관관계가 반영된 오차벡터 ($\eta L \cdot Z$)를 생성한다.
    4. 99.5% 충격시나리오 : $Z$ 벡터의 크기(norm)를 2.58에 맞춰 조정한다.
    </GCallout>
</AccordionTab>
<AccordionTab header="위험의 증대방향 결정 ">
    - – 금리상승/하락, 기울기완만/가파름 각 위험의 방향성을 결정한다.
            
</AccordionTab>
<AccordionTab header="충격벡터의 계산 ">
    - – 다변량충격벡터와 위험의 증대방향을 반영하여 현재시점 factor를 구한다. 
    - – $\beta^{stressed} = \beta^{base} + \eta^{stressed}$
            
</AccordionTab>
</Accordion>

### 수익률 곡선 산출 
- 도출된 팩터 값을 DNS모형 식에 대입하면 특정 시점(1년 후) 발생 가능한 99.5% 충격시나리오 하의 수익률 곡선 추정 

</Steps>
